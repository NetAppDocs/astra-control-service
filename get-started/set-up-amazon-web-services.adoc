---
sidebar: sidebar
permalink: get-started/set-up-amazon-web-services.html
keywords: set up service account, create service account, project, permissions, service account permissions, key, service account key, json, key json, roles, service account roles, apis, networking, private service access, kubernetes cluster, cluster requirements, version requirements, supported versions, supported regions, kubernetes version, ubuntu, image type, networking, container os
summary: A few steps are required to prepare your Amazon Web Services project before you can manage Amazon Elastic Kubernetes Service clusters with Astra Control Service.
---

= Set up Amazon Web Services
:hardbreaks:
:icons: font
:imagesdir: ../media/get-started/

A few steps are required to prepare your Amazon Web Services project before you can manage Amazon Elastic Kubernetes Service (EKS) clusters with Astra Control Service.

== Quick start for setting up Amazon Web Services

Get started quickly by following these steps or scroll down to the remaining sections for full details.

=== image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-1.png[One] Review Astra Control Service requirements for Amazon Web Services

[role="quick-margin-para"]
Ensure that clusters are healthy and running a Kubernetes version in the range of 1.20 to 1.22, that worker nodes are online and running Container-Optimized OS or Ubuntu, and more. <<EKS cluster requirements,Learn more about this step>>.

=== image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-2.png[Two] (Optional): Sign up for Amazon Web Services

[role="quick-margin-para"]
If you plan to use Cloud Volumes Service for Google Cloud as a storage backend, go to the NetApp Cloud Volumes Service page in the Google Cloud Marketplace and select Purchase. <<Sign up for Amazon Web Services (optional),Learn more about this step>>.

=== image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-4.png[Four] Create an IAM role and associate it with a service account

[role="quick-margin-para"]
Create an Amazon Elastic Kubernetes Service Identity and Access Management (IAM) role and associate that role with a Kubernetes service account.

[role="quick-margin-para"]
<<Create an IAM role and associate it with a service account,Read step-by-step instructions>>.

=== image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-5.png[Five] Create a service account key

[role="quick-margin-para"]
Create a key for the service account and save the key file in a secure location. <<Create a service account key,Follow step-by-step instructions>>.





== EKS cluster requirements

A Kubernetes cluster must meet the following requirements so you can discover and manage it from Astra Control Service. Note that some of these requirements only apply if you plan to use Cloud Volumes Service for Google Cloud as a storage backend.

Kubernetes version:: A cluster must be running a Kubernetes version in the range of 1.19 to 1.23.

Image type:: The image type for each worker node must be one of the following:
* Container-Optimized OS with Containerd
* Container-Optimized OS with Docker
* Ubuntu with Docker

Cluster state:: Clusters must be running in a healthy state and have at least one online worker node with no worker nodes in a failed state.

Google Cloud region:: If you plan to use Cloud Volumes Service for Google Cloud as a storage backend, clusters must be running in a https://cloud.netapp.com/cloud-volumes-global-regions#cvsGc[Google Cloud region where Cloud Volumes Service for Google Cloud is supported.] Note that Astra Control Service supports both service types: CVS and CVS-Performance. As a best practice, you should choose a region that supports Cloud Volumes Service for Google Cloud, even if you do not use it as a storage backend. This makes it easier to use Cloud Volumes Service for Google Cloud as a storage backend in the future if your performance requirements change.

Networking::

Private clusters:: If the cluster is private, the https://cloud.google.com/kubernetes-engine/docs/concepts/private-cluster-concept[authorized networks^] must allow the Astra Control Service IP address:
+
52.188.218.166/32


== Purchase Cloud Volumes Service for Google Cloud (optional)

Astra Control Service can use Cloud Volumes Service for Google Cloud as the storage backend for your persistent volumes. If you plan to use this service, you need to purchase Cloud Volumes Service for Google Cloud from the Google Cloud Marketplace to enable billing for persistent volumes.

.Step

. Go to the https://console.cloud.google.com/marketplace/product/endpoints/cloudvolumesgcp-api.netapp.com[NetApp Cloud Volumes Service page^] in the Google Cloud Marketplace, select *Purchase*, and follow the prompts.
+
https://cloud.google.com/solutions/partners/netapp-cloud-volumes/quickstart#purchase_the_service[Follow step-by-step instructions in the Google Cloud documentation to purchase and enable the service^].


== Create a service account

Astra Control Service uses a Google Cloud service account to facilitate Kubernetes application data management on your behalf.

.Steps

. Go to Google Cloud and https://cloud.google.com/iam/docs/creating-managing-service-accounts#creating_a_service_account[create a service account by using the console, gcloud command, or another preferred method^].

. Grant the service account the following roles:
+
* *Kubernetes Engine Admin* - Used to list clusters and create admin access to manage apps.

* *NetApp Cloud Volumes Admin* - Used to manage persistent storage for apps.

* *Storage Admin* - Used to manage buckets and objects for backups of apps.

* *Service Usage Viewer* - Used to check if the required Cloud Volumes Service for Google Cloud APIs are enabled.

* *Compute Network Viewer* - Used to check if the Kubernetes VPC is allowed to reach Cloud Volumes Service for Google Cloud.

If you'd like to use gcloud, you can follow steps from within the Astra Control interface. Select *Account > Credentials > Add Credentials*, and then select *Instructions*.

If you'd like to use the Google Cloud console, the following video shows how to create the service account from the console.

video::video-create-gcp-service-account.mp4[width=848, height=480]


== Create a service account key

Instead of providing a user name and password to Astra Control Service, you'll provide a service account key when you add your first cluster. Astra Control Service uses the service account key to establish the identity of the service account that you just set up.

The service account key is plaintext stored in the JavaScript Object Notation (JSON) format. It contains information about the GCP resources that you have permission to access.

You can only view or download the JSON file when you create the key. However, you can create a new key at any time.

.Steps

. Go to Google Cloud and https://cloud.google.com/iam/docs/creating-managing-service-account-keys#creating_service_account_keys[create a service account key by using the console, gcloud command, or another preferred method^].

. When prompted, save the service account key file in a secure location.
